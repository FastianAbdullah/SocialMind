import{a as o}from"./app-9fd18fea.js";import"./vendor-e5a96731.js";class d{constructor(){this.baseURL="/ai-assistant",this.conversationContext={currentTask:null,state:"idle"}}async processQuery(t){try{console.log("Processing query with context:",this.conversationContext);const e=await o.post(`${this.baseURL}/process-query`,{query:t,context:this.conversationContext},{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});return console.log("Query response:",e.data),e.data&&this.updateContext(e.data),e.data}catch(e){return console.error("Error processing query:",e),{message:"Sorry, I encountered an error processing your request.",actions:["Try again"],state:"error",intent:"error"}}}updateContext(t){t.state&&(this.conversationContext.state=t.state),t.intent&&(this.conversationContext.intent=t.intent),t.content&&(this.conversationContext.currentTask||(this.conversationContext.currentTask={}),this.conversationContext.currentTask.content=t.content),t.platforms&&(this.conversationContext.currentTask||(this.conversationContext.currentTask={}),this.conversationContext.currentTask.platforms=t.platforms),t.suggestions&&(this.conversationContext.currentTask||(this.conversationContext.currentTask={}),this.conversationContext.currentTask.suggestions=t.suggestions),console.log("Updated context:",this.conversationContext)}async generateContent(t,e=null){try{const n=await o.post(`${this.baseURL}/generate-content`,{topic:t,platform:e,context:this.conversationContext},{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});return n.data&&this.updateContext(n.data),n.data}catch(n){return console.error("Error generating content:",n),{message:"Sorry, I encountered an error generating content.",actions:["Try again"],state:"error",intent:"error"}}}async suggestPostingTimes(t){try{const e=await o.get(`${this.baseURL}/suggest-times/${t}`,{headers:{"X-Requested-With":"XMLHttpRequest"}});return e.data&&this.updateContext(e.data),e.data}catch(e){return console.error("Error getting posting times:",e),{message:`Sorry, I couldn't retrieve optimal posting times for ${t}.`,actions:["Try again"],state:"error",intent:"error"}}}async analyzePerformance(t,e){try{const n=await o.post(`${this.baseURL}/analyze-performance`,{post_id:t,platform:e,context:this.conversationContext},{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});return n.data&&this.updateContext(n.data),n.data}catch(n){return console.error("Error analyzing performance:",n),{message:"Sorry, I encountered an error analyzing performance data.",actions:["Try again"],state:"error",intent:"error"}}}async postContent(t,e,n=null){var i;try{const s=e.map(r=>{if(typeof r=="object"&&r.platform_id)return r;if(typeof r=="number")return{platform_id:r};if(typeof r=="string"&&!isNaN(Number(r)))return{platform_id:Number(r)};const u={facebook:1,instagram:2,linkedin:3};return typeof r=="string"&&u[r.toLowerCase()]?{platform_id:u[r.toLowerCase()]}:r});console.log("Formatted platforms for posting:",s);const c={...this.conversationContext,originalPrompt:((i=this.conversationContext.currentTask)==null?void 0:i.topic)||this.conversationContext.query||"Content generation request"};console.log("Context for posting with original prompt:",c);const a=await o.post(`${this.baseURL}/post-content`,{content:t,platforms:s,schedule_time:n,context:c},{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});return a.data&&this.updateContext(a.data),a.data}catch(s){return console.error("Error posting content:",s),{message:"Sorry, I encountered an error posting your content.",actions:["Try again"],state:"error",intent:"error"}}}resetContext(){this.conversationContext={currentTask:null,state:"idle"}}}const l=new d;export{l as default};
